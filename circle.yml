machine:
  php:
    version: 5.6.2

dependencies:
  pre:
    - composer config --global github-oauth.github.com ${COMPOSER_OAUTH_TOKEN}

test:
  override:
    - phpunit --coverage-clover {$CIRCLE_ARTIFACTS}/coverage.clover

  post:
    - wget https://scrutinizer-ci.com/ocular.phar
    - php ocular.phar code-coverage:upload --access-token="${SCRUTINIZER_ACCESS_TOKEN}" --format=php-clover {$CIRCLE_ARTIFACTS}/coverage.clover
